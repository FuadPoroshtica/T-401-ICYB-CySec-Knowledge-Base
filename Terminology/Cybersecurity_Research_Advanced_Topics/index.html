
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Cybersecurity Knowledge Base for T-401-ICYB Course">
      
      
        <meta name="author" content="Group 7">
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Cybersecurity Research: Advanced Topics - T-401-ICYB CySec Knowledge Base</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cybersecurity-research-advanced-topics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="T-401-ICYB CySec Knowledge Base" class="md-header__button md-logo" aria-label="T-401-ICYB CySec Knowledge Base" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            T-401-ICYB CySec Knowledge Base
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cybersecurity Research: Advanced Topics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/FuadPoroshtica/T-401-ICYB-CySec-Knowledge-Base" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    T-401-ICYB-CySec-Knowledge-Base
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Lecture%20Notes/2025-11-24%20Introduction%20%28G%C3%ADsli%29/" class="md-tabs__link">
          
  
  
  Lecture Notes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Attack%20Surface/" class="md-tabs__link">
          
  
  
  Terminology

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Tools%20and%20Commands/Attack%20Detection%20%26%20Monitoring/Attack%20Detection%20%26%20Monitoring/" class="md-tabs__link">
          
  
  
  Tools and Commands

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../resources/All%20the%20quizzes%20and%20the%20correct%20answers/" class="md-tabs__link">
          
  
  
  Resources

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="T-401-ICYB CySec Knowledge Base" class="md-nav__button md-logo" aria-label="T-401-ICYB CySec Knowledge Base" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    T-401-ICYB CySec Knowledge Base
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/FuadPoroshtica/T-401-ICYB-CySec-Knowledge-Base" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    T-401-ICYB-CySec-Knowledge-Base
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lecture Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lecture Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-11-24%20Introduction%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-11-24 Introduction (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-11-25%20Virtual%20Machines%20%28Fuad%20%26%20Kim%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Virtual Machines 2025-11-25
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-11-26%20Command-Line%20Interface%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-11-26 Command-Line Interface (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-11-27%20Operational%20Systems%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Operating System Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-11-27%20Operational%20Systems%20%28Ivan%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-11-27 Operational Systems (Ivan)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-11-27%20Operational%20Systems%20%28Kim%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-11-27 Operational Systems (Kim)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-11-28%20Phishing%20and%20AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-11-28 Phishing and AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-01%20OSINT%20%26%20Networks%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OSINT &amp; Networks 2025-12-01
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-02%20Networks%20-%20continuation%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12-02 Networks (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-03%20%20Web%20Security%20%26%20Attack%20Surfaces%20%28Fuad%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12-03 Web Security &amp; Attack Surfaces (Fuad)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-03%20AI%20Security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12-03 AI Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-03%20Web%20Security%20%26%20Web%20Attack%20Surfaces%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025 12 03 Web Security & Web Attack Surfaces (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-04%20AI%20Security%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025 12 04 AI Security (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-05%20Binary%20Exploitation%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12-05
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-08%20Principles%20of%20Defence%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025 12 08 Principles of Defence (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-09%20Information%20Warfare%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025 12 09 Information Warfare (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-09%20Information%20Warfare%20-%20Computer%20System%20Security%20%28Fuad%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Information Warfare - Computer System Security (Fuad)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-10%20Data%20Privacy%20%28Fuad%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12-10 Data Privacy (Fuad)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-11%20Summary%20%28Fuad%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12-11 Summary (Fuad)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/2025-12-11%20Summary%20%28G%C3%ADsli%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12-11 Introduction to Cyber Security Course Summary (Gísli)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_21" >
        
          
          <label class="md-nav__link" for="__nav_2_21" id="__nav_2_21_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Additional Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_21">
            <span class="md-nav__icon md-icon"></span>
            
  
    Additional Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/CLI%20Notes%20-%20Hreimur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Notes - Hreimur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/FurtherStudies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FurtherStudies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/IntroToCySec-Hreimur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IntroToCySec-Hreimur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/OS%20Notes%20-%20Hreimur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OS Notes   Hreimur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture%20Notes/Virtualization-Hreimur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Virtualization-Hreimur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Terminology
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Terminology
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Attack%20Surface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attack Surface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cyber%20Security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cyber Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vulnerability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vulnerability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Acronyms%20cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Acronyms cheatsheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tools and Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools and Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Attack%20Detection%20%26%20Monitoring/Attack%20Detection%20%26%20Monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attack Detection & Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Attack%20Prevention%20%26%20Hardening/Attack%20Prevention%20%26%20Hardening/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attack Prevention & Hardening
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Basic Bash Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Basic Bash Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Basic%20Bash%20commands/Basic%20Bash%20commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Basic%20Bash%20commands/grep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    grep
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Basic%20Bash%20commands/find/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    find
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Basic%20Bash%20commands/Regular%20Expression%20%28e%20g%20regex%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regular Expression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Forensics%20%26%20Incident%20Response/Forensics%20%26%20Incident%20Response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Forensics & Incident Response
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setup & Config
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setup & Config
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Setup%20%26%20Config/Qemu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Qemu
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools%20and%20Commands/Vulnerability%20Scanning%20%26%20Assessment/Vulnerability%20Scanning%20%26%20Assessment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vulnerability Scanning & Assessment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Resources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/All%20the%20quizzes%20and%20the%20correct%20answers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    All the quizzes and the correct answers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    References and Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Course Material
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Course Material
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/Course material/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Online Resources
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Online Resources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/Online Resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="cybersecurity-research-advanced-topics">Cybersecurity Research: Advanced Topics<a class="headerlink" href="#cybersecurity-research-advanced-topics" title="Permanent link">&para;</a></h1>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="about:blank#rootkit-attacks">Rootkit Attacks - Real Examples</a></li>
<li><a href="about:blank#side-channel-attacks">Side-Channel Attacks - Meltdown &amp; Spectre</a></li>
<li><a href="about:blank#dma-attacks">DMA Attacks - How They Work</a></li>
<li><a href="about:blank#suid-mitigation">SUID Mitigation Strategies</a></li>
</ol>
<hr />
<h1 id="1-rootkit-attacks-real-examples">1. Rootkit Attacks - Real Examples<a class="headerlink" href="#1-rootkit-attacks-real-examples" title="Permanent link">&para;</a></h1>
<h2 id="what-is-a-rootkit">What is a Rootkit?<a class="headerlink" href="#what-is-a-rootkit" title="Permanent link">&para;</a></h2>
<p>A rootkit is <a href="Attacks/Malware/Malware">malware</a> designed to hide its presence by intercepting and modifying system calls. Think of it as a dishonest accountant who alters the books - when you ask “show me all files,” the rootkit filters the output to hide malicious files and processes.</p>
<h2 id="famous-rootkit-attacks">Famous Rootkit Attacks<a class="headerlink" href="#famous-rootkit-attacks" title="Permanent link">&para;</a></h2>
<h3 id="sony-bmg-rootkit-2005-the-scandal-that-shocked-the-world">Sony BMG Rootkit (2005) - The Scandal That Shocked the World<a class="headerlink" href="#sony-bmg-rootkit-2005-the-scandal-that-shocked-the-world" title="Permanent link">&para;</a></h3>
<p><strong>What happened:</strong>
- Sony BMG embedded rootkits on over <strong>22 million music CDs</strong> as copy protection (DRM)
- When users played these CDs on their computers, the rootkit silently installed itself
- The rootkit hid any file starting with “<em>sys</em>” from users</p>
<p><strong>The Rootkit’s Role:</strong>
1. <strong>Concealment</strong>: Made the DRM software invisible to users and antivirus programs
2. <strong>Security Risk</strong>: Created vulnerabilities that other malware could exploit
3. <strong>System Instability</strong>: Slowed down computers and caused crashes
4. <strong>Privacy Violation</strong>: Sent user listening habits and IP addresses back to Sony without consent</p>
<p><strong>Discovery &amp; Consequences:</strong>
- Security researcher Mark Russinovich discovered it on October 31, 2005 using his rootkit detection tool (RootkitRevealer)
- Sony President’s infamous quote: “Most people don’t even know what a rootkit is, so why should they care about it?”
- Result: Class-action lawsuits, FTC investigation, CD recalls, and a massive PR disaster
- Security researchers criticized antivirus vendors for failing to detect it</p>
<p><strong>Key Lesson:</strong> This incident brought rootkits into public consciousness and showed that even “legitimate” companies could introduce dangerous malware.</p>
<hr />
<h3 id="stuxnet-2010-the-cyber-weapon">Stuxnet (2010) - The Cyber Weapon<a class="headerlink" href="#stuxnet-2010-the-cyber-weapon" title="Permanent link">&para;</a></h3>
<p><strong>What happened:</strong>
- Discovered in 2010, believed to be developed by the US and Israel
- Targeted Iran’s uranium enrichment facility at Natanz nuclear plant
- Infected over <strong>200,000 computers</strong> and destroyed approximately <strong>1,000 centrifuges</strong></p>
<p><strong>The Rootkit’s Role:</strong>
1. <strong>Stealth Operations</strong>: The rootkit component hid all files and processes from detection
2. <strong>Deception</strong>: Faked normal sensor readings so operators saw no problems
3. <strong>Persistence</strong>: Remained undetected for months while sabotaging centrifuges
4. <strong>Protection</strong>: Prevented antivirus software from detecting the <a href="Attacks/Malware/Worm">worm</a></p>
<p><strong>Technical Details:</strong>
- Kernel-mode rootkit that modified Windows kernel functions
- Targeted Siemens Step7 software controlling PLCs (Programmable Logic Controllers)
- Altered centrifuge speeds to tear them apart while displaying normal readings
- Used multiple zero-day vulnerabilities and sophisticated propagation methods</p>
<p><strong>Significance:</strong>
- First known cyberweapon to cause physical damage
- Demonstrated that rootkits could be used in nation-state cyber warfare
- Changed the landscape of critical infrastructure security</p>
<hr />
<h3 id="flame-flamer-2012-the-espionage-tool">Flame / Flamer (2012) - The Espionage Tool<a class="headerlink" href="#flame-flamer-2012-the-espionage-tool" title="Permanent link">&para;</a></h3>
<p><strong>What happened:</strong>
- Discovered in 2012, targeting Middle Eastern governments
- Used for espionage in Iran, Lebanon, Syria, Sudan, and Israel
- Believed to be created by the same nation-state actors behind Stuxnet</p>
<p><strong>The Rootkit’s Role:</strong>
1. <strong>Comprehensive Spying</strong>:
- Turned on microphones to record conversations
- Activated webcams to take photos
- Logged keystrokes to steal passwords
- Took screenshots of sensitive documents</p>
<ol>
<li><strong>Modularity</strong>: The rootkit supported at least 20 modules that could be swapped on-the-fly</li>
<li><strong>Deep Concealment</strong>: Hid itself inside system files, evading antivirus detection</li>
<li><strong>Network Interception</strong>: Monitored and captured network traffic</li>
</ol>
<p><strong>Sophistication Level:</strong>
- Approximately 20MB in size (huge for malware)
- Could spread via USB drives and network shares
- Remained undetected for approximately 5 years</p>
<hr />
<h3 id="rustock-2006-the-spam-king">Rustock (2006) - The Spam King<a class="headerlink" href="#rustock-2006-the-spam-king" title="Permanent link">&para;</a></h3>
<p><strong>What happened:</strong>
- Created one of the largest <a href="Attacks/Botnet">botnets</a> in history
- Infected between <strong>150,000 and 2.4 million</strong> computers
- Used primarily for sending spam emails</p>
<p><strong>The Rootkit’s Role:</strong>
1. <strong>Botnet Management</strong>: Hid the botnet client software from users
2. <strong>Resource Theft</strong>: Secretly used infected computers to send spam
3. <strong>Persistence</strong>: Made removal extremely difficult
4. <strong>Command &amp; Control</strong>: Maintained hidden communication channels with attackers</p>
<hr />
<h3 id="alureontdl-4-2011-the-mbr-rootkit">Alureon/TDL-4 (2011) - The MBR Rootkit<a class="headerlink" href="#alureontdl-4-2011-the-mbr-rootkit" title="Permanent link">&para;</a></h3>
<p><strong>What happened:</strong>
- Sophisticated rootkit that infected the Master Boot Record (MBR)
- Made it nearly impossible to remove without specialized tools</p>
<p><strong>The Rootkit’s Role:</strong>
1. <strong>Boot-Level Persistence</strong>: Loaded before the operating system
2. <strong>Deep System Control</strong>: Could modify kernel operations
3. <strong>Data Theft</strong>: Stole banking credentials and personal information
4. <strong><a href="Attacks/Backdoor">Backdoor</a> Creation</strong>: Allowed remote attacker access</p>
<p><strong>Why MBR rootkits are dangerous:</strong>
- Load before antivirus software starts
- Survive <a href="Operating System.md">OS</a> reinstallation
- Require special boot-time tools to detect and remove</p>
<hr />
<h2 id="common-pattern-across-all-rootkit-attacks">Common Pattern Across All Rootkit Attacks<a class="headerlink" href="#common-pattern-across-all-rootkit-attacks" title="Permanent link">&para;</a></h2>
<p>All these attacks follow a similar pattern:</p>
<ol>
<li><strong>Initial Compromise</strong>: Rootkit gets installed (via CD, USB, exploit, or social engineering)</li>
<li><strong>Hide &amp; Conceal</strong>: Rootkit intercepts system calls to hide files, processes, and network connections</li>
<li><strong>Maintain Access</strong>: Rootkit ensures persistence even after reboots</li>
<li><strong>Execute Payload</strong>: Carry out the actual malicious goal (spying, destruction, spam, etc.)</li>
<li><strong>Evade Detection</strong>: Continuously hide from antivirus and security tools</li>
</ol>
<hr />
<h1 id="2-side-channel-attacks-meltdown-spectre">2. <a href="../Virtualization/Side-Channel%20Attack/">Side-Channel Attacks</a> - Meltdown &amp; Spectre<a class="headerlink" href="#2-side-channel-attacks-meltdown-spectre" title="Permanent link">&para;</a></h1>
<h2 id="understanding-the-foundation-speculative-execution">Understanding the Foundation: Speculative Execution<a class="headerlink" href="#understanding-the-foundation-speculative-execution" title="Permanent link">&para;</a></h2>
<p>Modern CPUs use <strong>speculative execution</strong> to improve performance:</p>
<ul>
<li>Like a chef preparing popular dishes before orders come in</li>
<li>The CPU guesses which code will run next and executes it early</li>
<li>If the guess is wrong, results are discarded</li>
<li>If correct, time is saved!</li>
</ul>
<p><strong>The Critical Assumption (that turned out to be wrong):</strong>
CPU designers assumed that discarded speculative results leave NO traces. But they DO leave traces in the CPU cache, and these traces can be detected through timing attacks.</p>
<hr />
<h2 id="why-this-is-side-channel">Why This is “Side-Channel”<a class="headerlink" href="#why-this-is-side-channel" title="Permanent link">&para;</a></h2>
<p>A <strong>side-channel attack</strong> extracts information indirectly by observing the <em>side effects</em> of computation rather than directly reading the data.</p>
<p><strong>Analogy:</strong>
Imagine a secure vault where you can’t see inside:
- <strong>Direct attack</strong>: Try to break the lock (blocked by security)
- <strong>Side-channel attack</strong>: Listen to the clicking sounds the lock makes and deduce the combination</p>
<p>In Meltdown/Spectre:</p>
<ul>
<li><strong>Direct attack</strong>: Try to read kernel memory (blocked by permissions)</li>
<li><strong>Side-channel attack</strong>: Trick the CPU into speculatively accessing kernel memory, then measure cache timing to deduce what was accessed</li>
</ul>
<hr />
<h2 id="meltdown-reading-kernel-memory-from-user-mode">Meltdown: Reading Kernel Memory from User Mode<a class="headerlink" href="#meltdown-reading-kernel-memory-from-user-mode" title="Permanent link">&para;</a></h2>
<h3 id="how-meltdown-works-step-by-step">How Meltdown Works (Step-by-Step)<a class="headerlink" href="#how-meltdown-works-step-by-step" title="Permanent link">&para;</a></h3>
<p><strong>The Vulnerability:</strong>
Intel processors read memory BEFORE checking permissions during speculative execution.</p>
<p><strong>The Attack Process:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Step 1: Attacker&#39;s Code (User Mode)
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>  ↓
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>  Try to read kernel memory address (e.g., 0xFFFF...)
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  ↓
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>Step 2: CPU Speculation
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>  ↓
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>  Permission check hasn&#39;t happened yet
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  CPU speculatively reads the kernel memory
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>  Data gets loaded into CPU cache
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>  ↓
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>Step 3: Permission Check (Finally Happens)
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>  ↓
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>  &quot;Wait! User mode can&#39;t access kernel memory!&quot;
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>  CPU raises an exception
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>  Speculative results are discarded
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>  ↓
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>Step 4: Side-Channel Attack
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>  ↓
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>  Although results were discarded, the DATA is still in cache
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>  Attacker uses timing attack to detect what&#39;s in cache
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>  ↓
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>Step 5: Data Extracted!
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>  ↓
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>  Attacker now knows kernel memory contents
</span></code></pre></div>
<p><strong>Key Insight:</strong>
The CPU read the protected memory during speculation. Even though the operation was cancelled, the cache was modified, creating a detectable side effect.</p>
<h3 id="the-flushreload-technique">The Flush+Reload Technique<a class="headerlink" href="#the-flushreload-technique" title="Permanent link">&para;</a></h3>
<p>This is how attackers detect what’s in the cache:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>1. Prepare a &quot;probe array&quot; in memory
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>   array[0], array[1], array[2], ... array[255]
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>2. Flush all array elements from cache
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>3. Trigger speculative execution to read kernel byte
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>   The speculative code does: probe_array[kernel_byte * 256]
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>4. Time how long it takes to access each array element
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>   - If array[X] is FAST → it&#39;s in cache → kernel byte was X
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>   - If array[Y] is SLOW → not in cache → kernel byte wasn&#39;t Y
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>5. Repeat to read more bytes
</span></code></pre></div>
<p><strong>Why It Works:</strong>
- Cached data: ~5-10 CPU cycles to access
- Uncached data: ~200+ CPU cycles to access
- This timing difference is easily measurable</p>
<hr />
<h2 id="spectre-tricking-programs-into-leaking-secrets">Spectre: Tricking Programs Into Leaking Secrets<a class="headerlink" href="#spectre-tricking-programs-into-leaking-secrets" title="Permanent link">&para;</a></h2>
<h3 id="how-spectre-differs-from-meltdown">How Spectre Differs from Meltdown<a class="headerlink" href="#how-spectre-differs-from-meltdown" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Meltdown</th>
<th>Spectre</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploits out-of-order execution</td>
<td>Exploits branch prediction</td>
</tr>
<tr>
<td>Reads kernel memory</td>
<td>Tricks programs into revealing their own secrets</td>
</tr>
<tr>
<td>Specific to Intel (mostly)</td>
<td>Affects Intel, AMD, ARM</td>
</tr>
<tr>
<td>Can be patched by separating kernel/user page tables</td>
<td>Much harder to fix</td>
</tr>
</tbody>
</table>
<h3 id="spectre-variant-1-bounds-check-bypass">Spectre Variant 1: Bounds Check Bypass<a class="headerlink" href="#spectre-variant-1-bounds-check-bypass" title="Permanent link">&para;</a></h3>
<p><strong>The Setup:</strong>
Programs often have code like this:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">array_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="w">    </span><span class="c1">// Do something with value}</span>
</span></code></pre></div>
<p><strong>The Attack:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Step 1: Training Phase
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>  ↓
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  Attacker calls this code many times with valid x values
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  CPU&#39;s branch predictor learns: &quot;x &lt; array_size is usually TRUE&quot;
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>  ↓
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>Step 2: Attack Phase
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>  ↓
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>  Attacker provides x = 1000 (way out of bounds)
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>  CPU predicts: &quot;x &lt; array_size will be TRUE&quot; (wrong guess!)
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>  ↓
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>Step 3: Speculative Execution
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>  ↓
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>  Before checking x &lt; array_size, CPU speculatively executes:
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    value = array[1000]  // Reading out-of-bounds!
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>  ↓
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>Step 4: Side Channel
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>  ↓
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>  The out-of-bounds data gets into cache
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>  Attacker uses timing attack to extract it
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>  ↓
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>Step 5: CPU Realizes Mistake
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>  ↓
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>  &quot;Wait! x &gt;= array_size, the branch was wrong!&quot;
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>  Results are discarded, but cache still modified
</span></code></pre></div>
<p><strong>Real-World Impact:</strong>
This works in web browsers! JavaScript code on a malicious website can use Spectre to read data from other tabs or browser memory.</p>
<hr />
<h3 id="spectre-variant-2-branch-target-injection">Spectre Variant 2: Branch Target Injection<a class="headerlink" href="#spectre-variant-2-branch-target-injection" title="Permanent link">&para;</a></h3>
<p>This variant manipulates the <strong>Branch Target Buffer</strong> (BTB), which predicts where indirect jumps will go.</p>
<p><strong>The Attack:</strong>
1. Attacker trains the BTB to mispredict an indirect jump
2. CPU speculatively jumps to attacker-chosen code
3. That code accesses sensitive data
4. Side-channel extracts the data</p>
<hr />
<h2 id="why-these-attacks-dont-trigger-privilege-violations">Why These Attacks Don’t Trigger Privilege Violations<a class="headerlink" href="#why-these-attacks-dont-trigger-privilege-violations" title="Permanent link">&para;</a></h2>
<p><strong>The Genius of Meltdown/Spectre:</strong></p>
<p>They exploit the fact that modern CPUs operate in two “realities”:</p>
<ol>
<li><strong>Architectural State</strong> (What programs can see)<ul>
<li>Privilege checks are enforced here</li>
<li>Speculative results that failed checks are discarded</li>
<li>No privilege violation occurs at this level</li>
</ul>
</li>
<li><strong>Microarchitectural State</strong> (Internal CPU state)<ul>
<li>Cache contents, timing behavior</li>
<li>Speculative execution affects this state</li>
<li>Changes here are NOT discarded</li>
</ul>
</li>
</ol>
<hr />
<h2 id="mitigations">Mitigations<a class="headerlink" href="#mitigations" title="Permanent link">&para;</a></h2>
<h3 id="software-mitigations">Software Mitigations<a class="headerlink" href="#software-mitigations" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>KPTI (Kernel Page Table Isolation)</strong><ul>
<li>Formerly called KAISER</li>
<li>Separates kernel and user page tables</li>
<li>Kernel memory not mapped in user space at all</li>
<li><strong>Cost</strong>: 5-30% performance hit</li>
</ul>
</li>
<li><strong>Retpoline</strong><ul>
<li>Replaces indirect jumps with returns</li>
<li>Prevents BTB manipulation</li>
<li>Mitigates Spectre Variant 2</li>
</ul>
</li>
<li><strong>Site Isolation (Browsers)</strong><ul>
<li>Chrome puts each website in separate process</li>
<li>Limits what Spectre can access</li>
</ul>
</li>
</ol>
<h3 id="hardware-mitigations">Hardware Mitigations<a class="headerlink" href="#hardware-mitigations" title="Permanent link">&para;</a></h3>
<p>New processors include:</p>
<ul>
<li>Hardware barriers that prevent speculation</li>
<li>Better permission checking during speculation</li>
<li>Reduced speculative execution windows</li>
</ul>
<hr />
<h2 id="why-these-are-called-side-channel-attacks">Why These Are Called “Side-Channel” Attacks<a class="headerlink" href="#why-these-are-called-side-channel-attacks" title="Permanent link">&para;</a></h2>
<p><strong>Summary:</strong></p>
<ol>
<li><strong>No Direct Access</strong>: Attackers never directly read protected memory</li>
<li><strong>Observe Side Effects</strong>: They observe timing differences in cache access</li>
<li><strong>Infer Secret Data</strong>: From timing patterns, they deduce the actual data</li>
<li><strong>No Privilege Escalation</strong>: Technically, no security boundary is crossed at the architectural level</li>
</ol>
<p>The attacks exploit the <strong>gap</strong> between what the CPU <em>architecturally promises</em> (security) and what it <em>microarchitecturally does</em> (speculation + caching).</p>
<hr />
<h1 id="3-dma-attacks-direct-memory-access">3. DMA Attacks - Direct Memory Access<a class="headerlink" href="#3-dma-attacks-direct-memory-access" title="Permanent link">&para;</a></h1>
<h2 id="what-is-dma-direct-memory-access">What is DMA (Direct Memory Access)?<a class="headerlink" href="#what-is-dma-direct-memory-access" title="Permanent link">&para;</a></h2>
<p><strong>Normal Memory Access:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>Device → CPU → MMU (checks permissions) → RAM
</span></code></pre></div>
<p><strong>DMA Access:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Device → RAM (bypasses CPU and OS entirely!)
</span></code></pre></div>
<p><strong>Why DMA Exists:</strong>
DMA is a legitimate performance feature that allows peripheral devices to access RAM directly without involving the CPU. This is essential for:
- Network cards (receiving packets at high speed)
- Graphics cards (rendering textures)
- Storage devices (reading/writing data)
- Audio devices (streaming sound)</p>
<p><strong>The Problem:</strong>
If a malicious device gets DMA access, it can read and write ANY part of RAM, including:
- Kernel memory
- Password databases
- Encryption keys
- Other users’ data</p>
<hr />
<h2 id="how-dma-attacks-work">How DMA Attacks Work<a class="headerlink" href="#how-dma-attacks-work" title="Permanent link">&para;</a></h2>
<h3 id="the-attack-process">The Attack Process<a class="headerlink" href="#the-attack-process" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Step 1: Physical Access
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>  ↓
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>  Attacker plugs malicious device into DMA-capable port:
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  - Thunderbolt
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>  - FireWire (IEEE 1394)
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>  - ExpressCard
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>  - PCIe slots
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>  - USB 4.0 (in some cases)
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>  - M.2 connectors
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>  ↓
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>Step 2: DMA Initialization
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>  ↓
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>  Device identifies itself to the system
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>  Requests (and gets) DMA access
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>  ↓
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>Step 3: Direct Memory Access
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>  ↓
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>  Device can now READ and WRITE anywhere in physical RAM
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>  Bypasses:
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>    ✗ Operating system security
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>    ✗ User permissions
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>    ✗ Login screens
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>    ✗ Encryption (if keys are in memory)
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>  ↓
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>Step 4: Attacker Actions
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>  ↓
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>  Options include:
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>  - Read memory to steal passwords/keys
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>  - Write memory to inject malware
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>  - Modify kernel structures to gain control
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>  - Bypass authentication screens
</span></code></pre></div>
<hr />
<h2 id="real-world-dma-attack-example-pcileech">Real-World DMA Attack Example: PCILeech<a class="headerlink" href="#real-world-dma-attack-example-pcileech" title="Permanent link">&para;</a></h2>
<p><strong>PCILeech</strong> is a tool created by Ulf Frisk that demonstrates DMA attacks.</p>
<h3 id="what-pcileech-can-do">What PCILeech Can Do:<a class="headerlink" href="#what-pcileech-can-do" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Dump Memory</strong><ul>
<li>Read entire system memory at 150MB/s</li>
<li>Extract passwords, encryption keys, documents</li>
</ul>
</li>
<li><strong>Bypass Login Screens</strong><ul>
<li>Patch kernel memory to skip authentication</li>
<li>Works on locked Windows, Linux, macOS systems</li>
</ul>
</li>
<li><strong>Install <a href="Attacks/Backdoor">Backdoors</a></strong><ul>
<li>Inject kernel modules</li>
<li>Install persistent <a href="Attacks/Malware/Malware">malware</a></li>
</ul>
</li>
<li><strong>Mount File System</strong><ul>
<li>Access all files as if logged in</li>
</ul>
</li>
</ol>
<h3 id="attack-scenario-unlocking-windows-10">Attack Scenario: Unlocking Windows 10<a class="headerlink" href="#attack-scenario-unlocking-windows-10" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>1. Attacker&#39;s Setup:
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>   - Laptop with PCILeech software
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>   - USB3380 device (DMA-capable adapter)
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>   - Physical access to target computer
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>2. Connection:
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>   - Plug adapter into Thunderbolt/M.2/PCIe port
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>   - PCILeech detects system memory
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>3. Run Command:
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>   pcileech.exe patch -sig unlock_win10x64
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>4. What Happens:
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>   - PCILeech scans memory for Windows login structures
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>   - Finds and modifies the authentication check
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>   - Changes it from &quot;if (password == correct) allow&quot;
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>     to &quot;allow&quot; (bypasses check entirely)
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>5. Result:
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>   - Any password now works!
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>   - Attacker gains full system access
</span></code></pre></div>
<hr />
<h2 id="why-this-is-so-dangerous">Why This is So Dangerous<a class="headerlink" href="#why-this-is-so-dangerous" title="Permanent link">&para;</a></h2>
<h3 id="bypasses-everything">Bypasses Everything<a class="headerlink" href="#bypasses-everything" title="Permanent link">&para;</a></h3>
<p><strong>Traditional Security Layers (All Bypassed):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>❌ User/Kernel Mode Separation
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>   - DMA doesn&#39;t care about CPU rings
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>❌ Memory Protection
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>   - DMA has full physical memory access
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>❌ ASLR (Address Space Layout Randomization)
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>   - Can scan all memory to find targets
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>❌ DEP/NX (Non-Executable Memory)
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>   - Can write executable code anywhere
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>❌ Full Disk Encryption
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>   - Encryption keys are in RAM!
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>❌ Login Passwords
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>   - Can patch authentication code
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>❌ Antivirus/EDR
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>   - Operates below their detection level
</span></code></pre></div>
<hr />
<h2 id="types-of-dma-attacks">Types of DMA Attacks<a class="headerlink" href="#types-of-dma-attacks" title="Permanent link">&para;</a></h2>
<h3 id="1-pre-boot-dma-attacks">1. Pre-Boot DMA Attacks<a class="headerlink" href="#1-pre-boot-dma-attacks" title="Permanent link">&para;</a></h3>
<p><strong>Target:</strong> Systems before <a href="Operating System.md">OS</a> loads
- UEFI Secure Boot can’t stop them
- BIOS protections ineffective
- Steal encryption keys before <a href="Operating System.md">OS</a> starts</p>
<p><strong>Example:</strong> FileVault password extraction on locked Macs (<a href="Vulnerability standards/CVE">CVE</a>-2016-7585)</p>
<h3 id="2-post-boot-dma-attacks">2. Post-Boot DMA Attacks<a class="headerlink" href="#2-post-boot-dma-attacks" title="Permanent link">&para;</a></h3>
<p><strong>Target:</strong> Running systems
- Bypass login screens
- Read live memory
- Inject <a href="Attacks/Malware/Malware">malware</a> into running kernel</p>
<h3 id="3-remote-dma-rdma-attacks">3. Remote DMA (RDMA) Attacks<a class="headerlink" href="#3-remote-dma-rdma-attacks" title="Permanent link">&para;</a></h3>
<p><strong>Target:</strong> Networked systems in data centers</p>
<p><strong>Throwhammer Attack:</strong>
- Exploits RDMA over high-speed networks
- Attacker sends network packets
- Triggers Rowhammer bit flips remotely
- Gains code execution without local access</p>
<hr />
<h2 id="vulnerable-ports-and-connections">Vulnerable Ports and Connections<a class="headerlink" href="#vulnerable-ports-and-connections" title="Permanent link">&para;</a></h2>
<h3 id="high-risk-dma-ports">High-Risk DMA Ports:<a class="headerlink" href="#high-risk-dma-ports" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Thunderbolt</strong> (1, 2, 3, 4)<ul>
<li>Direct PCIe access</li>
<li>High-speed data transfer</li>
<li>Most powerful for attacks</li>
</ul>
</li>
<li><strong>FireWire (IEEE 1394)</strong><ul>
<li>Legacy but still present</li>
<li>Direct memory access by design</li>
<li>Often enabled by default</li>
</ul>
</li>
<li><strong>ExpressCard</strong><ul>
<li>PCIe interface</li>
<li>Laptop expansion slot</li>
</ul>
</li>
<li><strong>USB 4.0</strong><ul>
<li>Can tunnel PCIe</li>
<li>Potentially DMA-capable</li>
</ul>
</li>
<li><strong>M.2 / PCIe Slots</strong><ul>
<li>Internal but accessible if case opened</li>
<li>Direct motherboard connection</li>
</ul>
</li>
</ol>
<hr />
<h2 id="defense-against-dma-attacks">Defense Against DMA Attacks<a class="headerlink" href="#defense-against-dma-attacks" title="Permanent link">&para;</a></h2>
<h3 id="1-iommu-inputoutput-memory-management-unit">1. IOMMU (Input/Output Memory Management Unit)<a class="headerlink" href="#1-iommu-inputoutput-memory-management-unit" title="Permanent link">&para;</a></h3>
<p><strong>What it does:</strong>
- Creates “virtual memory” for DMA devices
- Restricts which memory addresses devices can access
- Like a <a href="Defense &amp; Control/Firewall">firewall</a> for DMA</p>
<p><strong>Intel:</strong> VT-d
<strong>AMD:</strong> AMD-Vi</p>
<p><strong>How to enable:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>1. Enter BIOS/UEFI settings
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>2. Find &quot;Virtualization&quot; or &quot;IOMMU&quot; settings
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>3. Enable VT-d (Intel) or AMD-Vi (AMD)
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>4. Save and reboot
</span></code></pre></div>
<h3 id="2-thunderbolt-security-levels">2. Thunderbolt Security Levels<a class="headerlink" href="#2-thunderbolt-security-levels" title="Permanent link">&para;</a></h3>
<p>Modern systems have Thunderbolt security settings:</p>
<ul>
<li><strong>Legacy Mode</strong>: ❌ NO PROTECTION - allows all DMA</li>
<li><strong>User Authorization</strong>: ✅ Prompts before allowing new devices</li>
<li><strong>Secure Connect</strong>: ✅ Requires cryptographic authentication</li>
<li><strong>Display Port Only</strong>: ✅ Disables PCIe tunneling</li>
</ul>
<h3 id="3-kernel-dma-protection-windows">3. Kernel DMA Protection (Windows)<a class="headerlink" href="#3-kernel-dma-protection-windows" title="Permanent link">&para;</a></h3>
<p>Windows 10/11 feature:</p>
<ul>
<li>Enabled by default on new systems</li>
<li>Blocks DMA until <a href="Operating System.md">OS</a> fully boots</li>
<li>Uses IOMMU to restrict access</li>
</ul>
<h3 id="4-physical-security-measures">4. Physical Security Measures<a class="headerlink" href="#4-physical-security-measures" title="Permanent link">&para;</a></h3>
<p><strong>Best practices:</strong>
- Disable unused DMA ports in BIOS
- Use port locks on sensitive systems
- Set strong BIOS passwords
- Epoxy-fill unused ports (extreme cases)
- Monitor physical access to systems</p>
<h3 id="5-software-protections">5. Software Protections<a class="headerlink" href="#5-software-protections" title="Permanent link">&para;</a></h3>
<p><strong>Operating System Level:</strong>
- Keep <a href="Operating System.md">OS</a> updated
- Enable Secure Boot
- Enable Trusted Boot
- Use pre-boot authentication (TPM)</p>
<p><strong>Additional Measures:</strong>
- Deploy EDR (Endpoint Detection &amp; Response)
- Monitor for unusual DMA device connections
- Use ECC memory (can detect memory tampering)</p>
<hr />
<h2 id="detection-difficulty">Detection Difficulty<a class="headerlink" href="#detection-difficulty" title="Permanent link">&para;</a></h2>
<p><strong>Why DMA attacks are hard to detect:</strong></p>
<ol>
<li><strong>Below <a href="Operating System.md">OS</a> visibility</strong>: Operates at hardware level</li>
<li><strong>No software traces</strong>: Doesn’t execute code traditionally</li>
<li><strong>Fast execution</strong>: Can be completed in seconds</li>
<li><strong>Looks legitimate</strong>: DMA is a normal hardware feature</li>
</ol>
<p><strong>Forensic indicators:</strong>
- Unexpected system reboots
- Suspicious device connection logs
- Changes in system behavior after physical access</p>
<hr />
<h1 id="4-suid-mitigation-strategies">4. SUID Mitigation Strategies<a class="headerlink" href="#4-suid-mitigation-strategies" title="Permanent link">&para;</a></h1>
<h2 id="understanding-the-suid-risk">Understanding the SUID Risk<a class="headerlink" href="#understanding-the-suid-risk" title="Permanent link">&para;</a></h2>
<p><strong>Why SUID is dangerous:</strong>
- Allows temporary privilege escalation to root
- If a SUID program has ANY vulnerability, attacker gets root
- Many programs not designed to be secure with SUID</p>
<p><strong>Common SUID attack vectors:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>SUID-enabled program that:
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>1. Allows arbitrary command execution (find, vim, nano)
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>2. Allows arbitrary file writes (cp, mv, dd)
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>3. Allows arbitrary file reads (cat, less, more)
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>4. Has buffer overflow vulnerabilities
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>5. Uses insecure PATH handling
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>6. Follows symlinks unsafely
</span></code></pre></div>
<hr />
<h2 id="comprehensive-mitigation-strategies">Comprehensive Mitigation Strategies<a class="headerlink" href="#comprehensive-mitigation-strategies" title="Permanent link">&para;</a></h2>
<h3 id="1-minimize-suid-binary-usage">1. Minimize SUID Binary Usage<a class="headerlink" href="#1-minimize-suid-binary-usage" title="Permanent link">&para;</a></h3>
<p><strong>Principle:</strong> If you don’t need SUID, don’t use SUID!</p>
<p><strong>Best Practices:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Find all SUID filesfind / -perm -4000 -type f -ls 2&gt;/dev/null</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c1"># Remove SUID bit from unnecessary programschmod u-s /path/to/program</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># Example: Remove SUID from find (if not needed)chmod u-s /usr/bin/find</span>
</span></code></pre></div>
<p><strong>Review checklist:</strong>
- ✅ Only keep SUID on essential programs (passwd, sudo, su, mount)
- ✅ Remove SUID from file editors (nano, vim, less, more)
- ✅ Remove SUID from utilities (find, nmap, cp, mv)
- ✅ Remove SUID from custom/third-party programs</p>
<hr />
<h3 id="2-use-linux-capabilities-instead">2. Use Linux Capabilities Instead<a class="headerlink" href="#2-use-linux-capabilities-instead" title="Permanent link">&para;</a></h3>
<p><strong>What are capabilities?</strong>
Fine-grained privileges instead of all-or-nothing root access.</p>
<p><strong>Example:</strong>
Instead of making <code>ping</code> SUID root (which gives full root powers), give it only the capability it needs:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Remove SUID bitchmod u-s /bin/ping</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c1"># Add only the capability needed (send raw packets)setcap cap_net_raw+ep /bin/ping</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># Verifygetcap /bin/ping</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Output: /bin/ping = cap_net_raw+ep</span>
</span></code></pre></div>
<p><strong>Common useful capabilities:</strong>
- <code>CAP_NET_RAW</code>: Send raw network packets (ping, traceroute)
- <code>CAP_NET_BIND_SERVICE</code>: Bind to ports &lt; 1024 (web servers)
- <code>CAP_DAC_READ_SEARCH</code>: Read files regardless of permissions
- <code>CAP_SYS_TIME</code>: Set system time</p>
<hr />
<h3 id="3-regular-suid-audits">3. Regular SUID Audits<a class="headerlink" href="#3-regular-suid-audits" title="Permanent link">&para;</a></h3>
<p><strong>Automated audit script:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="ch">#!/bin/bash# audit_suid.sh - Check for suspicious SUID binaries# Get list of current SUID binariesfind / -perm -4000 -type f 2&gt;/dev/null &gt; /tmp/current_suid.txt</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c1"># Compare with baseline (create baseline first time)if [ ! -f /etc/security/suid_baseline.txt ]; then    cp /tmp/current_suid.txt /etc/security/suid_baseline.txt</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Baseline created&quot;</span><span class="k">else</span><span class="w">    </span><span class="c1"># Check for new SUID binaries    diff /etc/security/suid_baseline.txt /tmp/current_suid.txt</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;WARNING: SUID binaries changed!&quot;</span><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;New/Changed binaries:&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>mail<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;SUID Alert&quot;</span><span class="w"> </span>admin@company.com
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span>fifi
</span></code></pre></div>
<p><strong>Run this:</strong>
- Daily via cron
- After software installations
- After system updates</p>
<hr />
<h3 id="4-enhanced-monitoring-logging">4. Enhanced Monitoring &amp; Logging<a class="headerlink" href="#4-enhanced-monitoring-logging" title="Permanent link">&para;</a></h3>
<p><strong>Monitor SUID execution:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Using auditd to monitor SUID execution# Add this rule to /etc/audit/rules.d/suid.rules# Watch all SUID binary execution-a always,exit -F arch=b64 -S execve -F perm=u+s -k suid_execution</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>-a<span class="w"> </span>always,exit<span class="w"> </span>-F<span class="w"> </span><span class="nv">arch</span><span class="o">=</span>b32<span class="w"> </span>-S<span class="w"> </span>execve<span class="w"> </span>-F<span class="w"> </span><span class="nv">perm</span><span class="o">=</span>u+s<span class="w"> </span>-k<span class="w"> </span>suid_execution
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1"># Reload rulessudo auditctl -R /etc/audit/rules.d/suid.rules</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c1"># Query logsausearch -k suid_execution</span>
</span></code></pre></div>
<p><strong>What to monitor:</strong>
- Unusual SUID binary execution
- SUID execution by unexpected users
- Multiple rapid SUID executions (may indicate attack)
- SUID binaries executing at odd hours</p>
<hr />
<h3 id="5-selinux-apparmor-mandatory-access-control">5. SELinux / AppArmor Mandatory Access Control<a class="headerlink" href="#5-selinux-apparmor-mandatory-access-control" title="Permanent link">&para;</a></h3>
<p><strong>SELinux:</strong>
Even if attacker exploits SUID, SELinux policies can restrict what they can do.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Check SELinux statussestatus# Enable SELinux# Edit /etc/selinux/configSELINUX=enforcing</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c1"># Create policy for SUID program# Only allow it to access specific files/directories</span>
</span></code></pre></div>
<p><strong>AppArmor (Ubuntu/Debian):</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Check AppArmor statussudo aa-status</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="c1"># Create profile for SUID binarysudo aa-genprof /usr/bin/program</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># Enforce profilesudo aa-enforce /usr/bin/program</span>
</span></code></pre></div>
<hr />
<h3 id="6-secure-suid-program-development">6. Secure SUID Program Development<a class="headerlink" href="#6-secure-suid-program-development" title="Permanent link">&para;</a></h3>
<p>If you MUST create a custom SUID program:</p>
<p><strong>Security checklist:</strong></p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1">// Example: Secure SUID program template#include &lt;stdio.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) {    // 1. Clear environment variables    clearenv();    // 2. Set secure PATH    setenv(&quot;PATH&quot;, &quot;/usr/bin:/bin&quot;, 1);    // 3. Validate all inputs    if (argc != 2) {        fprintf(stderr, &quot;Invalid arguments\n&quot;);        return 1;    }    // 4. Drop privileges ASAP after necessary operations    uid_t real_uid = getuid();    setuid(real_uid);  // Drop SUID privileges    // 5. Never call system() or exec() with user input    // WRONG: system(argv[1]);  // NEVER DO THIS!    // 6. Validate file paths (no symlinks, no ../)    char *file = argv[1];    if (strstr(file, &quot;..&quot;) || strstr(file, &quot;/etc/&quot;)) {        fprintf(stderr, &quot;Invalid path\n&quot;);        return 1;    }    return 0;}</span>
</span></code></pre></div>
<p><strong>Key principles:</strong>
- ✅ Validate ALL inputs
- ✅ Use whitelist approach (not blacklist)
- ✅ Drop privileges immediately after needed
- ✅ Never execute user-provided commands
- ✅ Use full paths for executables
- ✅ Check for symlinks before file operations</p>
<hr />
<h3 id="7-sudo-with-restricted-commands">7. sudo with Restricted Commands<a class="headerlink" href="#7-sudo-with-restricted-commands" title="Permanent link">&para;</a></h3>
<p><strong>Instead of SUID, use sudo with restrictions:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># /etc/sudoers configuration# Allow user to run specific command with specific arguments onlyjohn ALL=(root) NOPASSWD: /usr/bin/systemctl restart apache2</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c1"># Allow reading logs only (no write/execute)webadmin ALL=(root) NOPASSWD: /usr/bin/tail -f /var/log/apache2/*# Prevent shell escapesengineer ALL=(root) NOPASSWD: !/bin/bash, !/bin/sh, /usr/local/bin/deploy.sh</span>
</span></code></pre></div>
<p><strong>Advantages over SUID:</strong>
- More granular control
- Better logging (sudo logs everything)
- Can restrict arguments
- Easier to audit</p>
<hr />
<h3 id="8-filesystem-restrictions">8. Filesystem Restrictions<a class="headerlink" href="#8-filesystem-restrictions" title="Permanent link">&para;</a></h3>
<p><strong>Mount options to restrict SUID:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># /etc/fstab# Mount /tmp with nosuid option (SUID won&#39;t work here)tmpfs /tmp tmpfs defaults,nosuid,nodev,noexec 0 0</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c1"># Mount home directories with nosuid/dev/sda5 /home ext4 defaults,nosuid,nodev 0 2</span>
</span></code></pre></div>
<p><strong>This prevents:</strong>
- Users creating SUID programs in their home directories
- Attackers planting SUID backdoors in /tmp</p>
<hr />
<h3 id="9-detection-tools">9. Detection Tools<a class="headerlink" href="#9-detection-tools" title="Permanent link">&para;</a></h3>
<p><strong>Automated security scanning:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Lynis security auditsudo lynis audit system</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c1"># Checks for:# - Unusual SUID binaries# - World-writable SUID files# - Weak file permissions# rkhunter (rootkit hunter)sudo rkhunter --check# Detects suspicious SUID binaries# OSSEC (open-source HIDS)# Monitors SUID binary changes in real-time</span>
</span></code></pre></div>
<hr />
<h3 id="10-training-and-policy">10. Training and Policy<a class="headerlink" href="#10-training-and-policy" title="Permanent link">&para;</a></h3>
<p><strong>Administrative policies:</strong></p>
<ol>
<li><strong>Change Management</strong><ul>
<li>Document all SUID changes</li>
<li>Require approval before setting SUID</li>
<li>Security review for all custom SUID programs</li>
</ul>
</li>
<li><strong>Least Privilege</strong><ul>
<li>Don’t grant SUID “just in case”</li>
<li>Re-evaluate periodically</li>
<li>Remove SUID when no longer needed</li>
</ul>
</li>
<li><strong>Security Training</strong><ul>
<li>Educate developers about SUID risks</li>
<li>Show examples of SUID exploits</li>
<li>Teach secure alternatives</li>
</ul>
</li>
</ol>
<hr />
<h2 id="summary-defense-in-depth">Summary: Defense in Depth<a class="headerlink" href="#summary-defense-in-depth" title="Permanent link">&para;</a></h2>
<p><strong>Layer 1: Prevention</strong>
- Minimize SUID usage
- Use capabilities instead
- Secure development practices</p>
<p><strong>Layer 2: Detection</strong>
- Audit SUID binaries regularly
- Monitor SUID execution
- Use automated scanning tools</p>
<p><strong>Layer 3: Containment</strong>
- SELinux/AppArmor policies
- Filesystem mount options (nosuid)
- Restricted sudo rules</p>
<p><strong>Layer 4: Response</strong>
- Incident response procedures
- Regular backup and recovery
- Security patches and updates</p>
<hr />
<h2 id="quick-reference-commands-for-suid-management">Quick Reference: Commands for SUID Management<a class="headerlink" href="#quick-reference-commands-for-suid-management" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Find all SUID binariesfind / -perm -4000 -type f -ls 2&gt;/dev/null</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c1"># Remove SUID bitchmod u-s /path/to/file</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c1"># Add SUID bit (use carefully!)chmod u+s /path/to/file</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># Check file permissionsls -l /path/to/file</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1"># Look for &#39;s&#39; in user permissions: -rwsr-xr-x# Use capabilities insteadsetcap cap_net_raw+ep /bin/ping</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>getcap<span class="w"> </span>/bin/ping
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1"># Monitor SUID execution (auditd)auditctl -w /usr/bin/suspicious_program -p x -k suid_watch</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>ausearch<span class="w"> </span>-k<span class="w"> </span>suid_watch
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c1"># List capabilities of binarygetcap -r / 2&gt;/dev/null</span>
</span></code></pre></div>
<hr />
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>SUID is a powerful but dangerous feature. The key to securing it is:</p>
<ol>
<li><strong>Use it sparingly</strong> - only when absolutely necessary</li>
<li><strong>Audit regularly</strong> - know what has SUID on your systems</li>
<li><strong>Monitor actively</strong> - detect suspicious SUID usage</li>
<li><strong>Layer defenses</strong> - SELinux, capabilities, file system restrictions</li>
<li><strong>Educate users</strong> - awareness prevents misconfigurations</li>
</ol>
<p>Remember: <strong>The best SUID mitigation is not using SUID at all!</strong> Explore alternatives like capabilities, sudo, or redesigning the application.</p>
<hr />
<h1 id="additional-resources">Additional Resources<a class="headerlink" href="#additional-resources" title="Permanent link">&para;</a></h1>
<h2 id="rootkits">Rootkits<a class="headerlink" href="#rootkits" title="Permanent link">&para;</a></h2>
<ul>
<li>Mark Russinovich’s RootkitRevealer tool</li>
<li>“Rootkits: Subverting the Windows Kernel” by Greg Hoglund</li>
<li>SANS Institute: Rootkit Detection and Prevention</li>
</ul>
<h2 id="side-channel-attacks"><a href="../Virtualization/Side-Channel%20Attack/">Side-Channel Attacks</a><a class="headerlink" href="#side-channel-attacks" title="Permanent link">&para;</a></h2>
<ul>
<li>Original Meltdown paper: https://meltdownattack.com/meltdown.pdf</li>
<li>Original Spectre paper: https://spectreattack.com/spectre.pdf</li>
<li>Intel’s mitigation guide: https://software.intel.com/</li>
</ul>
<h2 id="dma-attacks">DMA Attacks<a class="headerlink" href="#dma-attacks" title="Permanent link">&para;</a></h2>
<ul>
<li>PCILeech GitHub: https://github.com/ufrisk/pcileech</li>
<li>Ulf Frisk’s blog: http://blog.frizk.net/</li>
<li>Eclypsium’s DMA research: https://eclypsium.com/</li>
</ul>
<h2 id="suid-security">SUID Security<a class="headerlink" href="#suid-security" title="Permanent link">&para;</a></h2>
<ul>
<li>GTFOBins (SUID exploit techniques): https://gtfobins.github.io/</li>
<li>Linux capabilities man page: <code>man capabilities</code></li>
<li>SELinux documentation: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_selinux/</li>
</ul>
<hr />
<p><em>Document prepared for cybersecurity education purposesLast updated: November 2024</em></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/FuadPoroshtica/T-401-ICYB-CySec-Knowledge-Base" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "toc.follow"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>